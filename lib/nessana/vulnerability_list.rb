class VulnerabilityList < Array
	FILTERABLE_RISKS = ['None']

	def self.from_csv(filename)
		data = CSV.read(filename)[1..-1].map do |row|
			Vulnerability.new(*row)
		end

		self.new(data)
	end

	def initialize(list = [])
		super(list)
	end

	def filter_risks(risks_to_filter = FILTERABLE_RISKS)
		self.class.new(self.select do |v|
			               !(risks_to_filter.include? v.risk)
		               end)
	end

	def filter_not_accessible
		dup
	end

	def report_for(**parameters)
		copy = dup

		parameters.each do |key, value|
			copy.select! do |vuln|
				vuln.respond_to?(key) && (vuln.send(key) == value)
			end
		end

		copy
	end
end
