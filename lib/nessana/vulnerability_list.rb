class VulnerabilityList < Array
	FILTERABLE_RISKS = ['None']

	def initialize(list = [])
		super(list)
	end

	# TODO filter risks from configuration file
	def filter_risks(risks_to_filter = FILTERABLE_RISKS)
		self.class.new(select do |v|
			               !(risks_to_filter.include? v.risk)
		               end)
	end

	# TODO use Cisco ACL parser
	def filter_not_accessible
		dup
	end

	def report_for(**parameters)
		copy = dup

		parameters.each do |key, value|
			copy.select! do |vuln|
				vuln.respond_to?(key) && (vuln.send(key) == value)
			end
		end

		copy
	end
end
